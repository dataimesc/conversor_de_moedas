<!DOCTYPE html>
<html>
<head>
 
  </head>
  <body  style=" background-image: linear-gradient(rgb(22, 111, 108), rgb(184, 39, 39));color: aliceblue;">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
    crossorigin="anonymous">
    <div style="margin-bottom: 30px;">
    <img src="logo2.png" id="logo" height="100" style="position:relative;top:30px">

  </div>

<h1 class="text-center" style="margin-bottom:20px;">COTAÇÕES DAS PRINCIPAIS MOEDAS EM TEMPO REAL</h1>
  <table id="currencyTable">
    <tr>
      <th>Código</th>
      <th>Código Inter</th>
      <th>Nome</th>
      <th>Maior</th>
      <th>Menor</th>
      <th>Variação</th>
      <th>Variação Percentual</th>
      <th>Compra</th>
      <th>Venda</th>
      <th>Última atualização</th>
      
    </tr>
    
  </table>
  <div id="result">
  <h2>Conversor de moeda:</h2>
  <label for="valor"style="font-size: smaller;">Valor em R$:</label><br>
  <input type="text" id="valor" oninput="formatCurrency(this)" placeholder="R$ 0.00" style="width:15%;"><br>
  <label for="select"style="font-size: smaller;">Moeda:</label>
  <select id="select" class="form-select" aria-label="Default select example" style="width:15%;">
    <option value="USDBRL">Dólar</option>
    <option value="EURBRL" selected>Euro</option>
    <option value="RUBBRL">Rublo</option>
    <option value="BTCBRL">Bitcoin</option>
  </select>
  <label for="select2"style="font-size: smaller;">Valor:</label>
  <select id="select2" class="form-select" aria-label="Default select example" style="width:15%;">
    <option value="ask">Compra</option>
    <option value="bid" selected>Venda</option>
  </select>
 <label for="firstbutton"style="font-size: smaller;"></label>
  <button  class="btn btn-primary" onclick=result() id="firstbutton">Converter</button>
  </div>
  
  <div id="resultado">
    <h4>Resultado:</h4>
    <div id="resultado2"></div>
    
  </div>
  <script>
        function formatCurrency(input) {
        let value = input.value;
        value = value.replace(/\D/g, '');
        value = Number(value) / 100;
        value = value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        input.value = value;
    };
    fetch('https://economia.awesomeapi.com.br/last/USD-BRL,EUR-BRL,BTC-BRL,RUB-BRL')
  .then(response => response.json())
  .then(data => {
    // Manipule os dados JSON aqui
    var json = data;
 var table = document.getElementById("currencyTable");

    for (var key in json) {
      if (json.hasOwnProperty(key)) {
        var row = table.insertRow();

        var codeCell = row.insertCell(0);
        codeCell.innerHTML = json[key].code;

        var codeinCell = row.insertCell(1);
        codeinCell.innerHTML = json[key].codein;

        var nameCell = row.insertCell(2);
        nameCell.innerHTML = json[key].name;

        var highCell = row.insertCell(3);
        highCell.innerHTML = json[key].high;

        var lowCell = row.insertCell(4);
        lowCell.innerHTML = json[key].low;

        var varBidCell = row.insertCell(5);
        varBidCell.innerHTML = json[key].varBid;

        var pctChangeCell = row.insertCell(6);
        pctChangeCell.innerHTML = json[key].pctChange+"%";

        var bidCell = row.insertCell(7);
        bidCell.innerHTML = json[key].bid;

        var askCell = row.insertCell(8);
        askCell.innerHTML = json[key].ask;

        var createDateCell= row.insertCell(9);
        createDateCell.innerHTML = json[key].create_date.toLocaleString([], {hour12: false,}).split(" ")[1];

        
        
  }
}})
function result(){
  console.log(document.getElementById('select').value)
  console.log(document.getElementById('select2').value)
  fetch('https://economia.awesomeapi.com.br/last/USD-BRL,EUR-BRL,BTC-BRL,RUB-BRL')
  .then(response => response.json())
  .then(data => {
    console.log(parseFloat(document.getElementById('valor').value.substr(3))
    )
    console.log(parseFloat(data[document.getElementById('select').value][document.getElementById('select2').value]))
  var valor2=parseFloat(document.getElementById('valor').value.substr(3).replaceAll(".",'').replaceAll(",",'.'))/parseFloat(data[document.getElementById('select').value][document.getElementById('select2').value]);
   console.log(valor2)

  document.getElementById("resultado2").innerHTML=`O valor convertido em ${(data[document.getElementById('select').value].name).split('/')[0]} é: ` + valor2.toFixed(2)
});

  }
;
  </script>
</body>
</html>
<style>
  table {
    border-collapse: collapse;
    width: 100%;
  }
  
  th, td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid #ddd;
  }
  #result{
    position:relative;
    left:30px;
    max-width:90%;
    overflow-x: hidden;
  }
  .button {
transition-duration: 0.4s;
}

.button:hover {
background-color: #4CAF50; /* Green */
color: white;
}
#currencyTable{
  border-collapse: collapse;
  margin: 25px 0;
  font-size: 0.9em;
  color:black;
  font-family: sans-serif;
  min-width: 400px;
  background-color: rgb(255, 255, 255);
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
}
#resultado{
  position:relative;
  top:-200px;
  left:300px;
  max-width:300px;
  
}
  
</style>
